<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1,maximum-scale=1, user-scalable=no"/>
    <title>平讯数据后台管理系统</title>
    <link href="bootstrap-3.3.5-dist/css/bootstrap.min.css" title="" rel="stylesheet"/>
    <link title="" href="cssold/style.css" rel="stylesheet" type="text/css"/>
    <link title="blue" href="cssold/dermadefault.css" rel="stylesheet" type="text/css"/>
    <link title="green" href="cssold/dermagreen.css" rel="stylesheet" type="text/css" disabled="disabled"/>
    <link title="orange" href="cssold/dermaorange.css" rel="stylesheet" type="text/css" disabled="disabled"/>
    <link href="assets/bootstrapValidator/bootstrapValidator.css" rel="stylesheet">
    <link href="cssold/templatecss.css" rel="stylesheet" title="" type="text/css"/>
    <script src="script/jquery-1.11.1.min.js" type="text/javascript"></script>
    <script src="script/jquery.cookie.js" type="text/javascript"></script>
    <link title="" href="cssold/pagination.css" rel="stylesheet" type="text/css"/>
    <script src="script/jquery.pagination.js" type="text/javascript"></script>
    <script src="script/pingxun.js" type="text/javascript"></script>
    <script src="script/highcharts.js" type="text/javascript"></script>
    <script src="script/exporting.js" type="text/javascript"></script>
    <script src="script/highcharts-3d.js" type="text/javascript"></script>
    <script src="script/highcharts-zh_CN.js" type="text/javascript"></script>
    <link rel="stylesheet" title="" type="text/css" href="ui-layout-0.0.0/ui-layout.css"/>
    <script src="script/angular.min.js"></script>
    <script src="ui-layout-0.0.0/ui-layout.js"></script>
    <link title="blue" href="script/jquery.mloading.css" rel="stylesheet" type="text/css"/>
    <script src="script/jquery.mloading.js" type="text/javascript"></script>
    <link title="blue" href="cssold/zTreeStyle/zTreeStyle.css" rel="stylesheet" type="text/css"/>
    <script src="script/layer.js" type="text/javascript"></script>
    <script language="javascript" type="text/javascript" src="script/WdatePicker.js"></script>
    <script src="bootstrap-3.3.5-dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="script/ajaxfileupload.js" type="text/javascript"></script>
    <!-- angular ui-->
    <script src="assets/bootstrapValidator/bootstrapValidator.js"></script><!-- scripit init-->
    <script src="assets/bootstrapValidator/zh_CN.js"></script><!-- scripit init-->
    <script src="script/jquery.ztree.core.js" type="text/javascript"></script>
    <script src="script/jquery.ztree.excheck.js" type="text/javascript"></script>
    <script type="text/javascript" src="script/jquery.ztree.exedit.js"></script>
</head>
<style>
    em {
        font-style: normal;
    }

    body {
        background: #f3f3f3;
        font-size: 14px;
    }

    .block-bg {
        background: #fff;
        padding: 20px 0;
        margin-bottom: 20px;
        text-align: left;
    }

    .pageIndex .title {
        font-size: 16px;
    }

    .pageIndex .title em {
        float: left;
        width: 6px;
        display: inline-block;
        border-radius: 5px;
        height: 22px;
        margin-right: 10px;
        background: #00a7e9;
        margin-left: 20px;
    }

    .pageIndex .con {
        padding: 15px;
    }

    .block-statis li {
        float: left;
        text-align: center;
        margin-right: 20px;
        font-size: 14px;
        background: #fff;
        width: 12%;
        padding: 20px 0 0;
    }

    .block-statis li span {
        font-size: 50px;
        font-family: Arial;
        line-height: 60px;
    }

    .block-statis li ul li {
        width: 49%;
        margin: 0;
        margin: 0 0 10px 0;
        padding: 0;
    }

    .block-statis li ul li.left {
        border-right: 1px solid #eee;
    }

    .block-statis li ul li em {
        color: #999;
    }

    .block-statis li ul li span {
        font-size: 20px;
        line-height: 30px;
    }

    .block-statis {
        margin-bottom: 20px;
    }

    .block-statis em {
        display: block;
    }

    .blcik-histogram {
        width: 65%;
        float: left;
    }

    .blcik-piechart {
        width: 34%;
        float: right;
    }

    .block-statisTabel {
        text-align: center;
    }

    .block-statisTabel .btn i {
        font-size: 16px;
        margin-left: 5px;
    }

    .blcik-lineChart .main-nav {
        width: 7rem;
        margin-left: 20px;
        text-align: center;
    }

    .blcik-lineChart .main-nav li {
        display: inline-block;
        width: 3rem;
        height: 2.5rem;
        line-height: 2.5rem;
        border: 1px solid #ccc;
        float: left;
    }

    .blcik-lineChart .main-nav .cur {
        color: #fff;
        background: #00a7e9;
        border: 1px solid #00a7e9;
    }
</style>
<body>
<div id="loadingModal" style="width: 100%;height:100%; z-index: 20000; position: fixed; text-align: center;background: rgba(0,0,0,0.6);display: none">
    　　<div >
    　　　　<img src="images/loading.gif" style="width: 50px;height: 50px;margin-top: 20%"/>
    　　</div>
</div>
<div id="navtop"></div>
<div class="down-main" id="downMain">
    <div class="left-main left-full" id="left">
    </div>
    <div class="right-product my-index right-full" id="contentContainer">
        <div class="container-fluid">
            <div class="info-center">

                <!-- title -->
                <div class="info-title">
                    <div class="pull-left">
                        <h4><strong><span id="loginUser"></span></strong></h4>
                        <p>欢迎登录管理系统！
                        </p>
                        <div class="form-group btn-search">
                            <form id="searchForm">
                                <div class="form-group">
                                    <span class="pull-left form-span">日期:</span>
                                    <input class="Wdate" type="text" name="applyDate"
                                           style="margin-top: 5px;height: 30px;" id="d15"
                                           onFocus="WdatePicker({isShowClear:false,readOnly:true})"/>
                                    <a href="javascript:void(0);" class="btn btn-default" onclick="toggleData()"><span
                                            class="glyphicon glyphicon-search"></span> 搜索</a>
                                </div>
                            </form>
                        </div>
                    </div>
                    <div class="time-title pull-right">
                        <div class="year-month pull-left">
                            <p><span id="weekShow"></span></p>
                            <p><span id="sysdate"></span></p>
                        </div>
                    </div>
                    <div class="clearfix"></div>
                </div>
                <!-- content-list -->
                <div class="pageIndex" style="width: 99%">
                    <div class="block-statis clearfix">
                        <ul>
                            <li><em>日新增用户数</em><span style="color:#997cec;font-size:40px;" id="dayUserCount">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">应用市场</em><span
                                            id="appMarketDayNum">0</span></li>
                                    <li><em style="font-size: 8px">推广渠道</em><span id="channelDayNum">0</span></li>
                                </ul>
                            </li>
                            <li><em>月新增用户数</em><span style="color:#4398ea;font-size:40px;" id="monthUserCount">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">应用市场</em><span
                                            id="appMarketMonthNum">0</span></li>
                                    <li><em style="font-size: 8px">推广渠道</em><span id="channelMonthNum">0</span></li>
                                </ul>
                            </li>
                            <li><em>日申请次数</em><span style="color:#997cec;font-size:40px;" id="dayApplyCount">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">应用市场</em><span
                                            id="appMarketDayApplyTime">0</span></li>
                                    <li><em style="font-size: 8px">推广渠道</em><span id="channelDayApplyNum">0</span></li>
                                </ul>
                            </li>
                            <li><em>日申请用户</em><span style="color:#997cec;font-size:40px;" id="applyNum">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">应用市场</em><span
                                            id="appMarketApplyNum">0</span></li>
                                    <li><em style="font-size: 8px">推广渠道</em><span id="channelApplyNum">0</span></li>
                                </ul>
                            </li>
                            <li><em>月申请次数</em><span style="color:#4398ea;font-size:40px;" id="monthApplyCount">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">应用市场</em><span
                                            id="appMarketMonthApplyTime">0</span></li>
                                    <li><em style="font-size: 8px">推广渠道</em><span id="channelApplyTime">0</span></li>
                                </ul>
                            </li>
                            <li><em>月申请用户</em><span style="color:#4398ea;font-size:40px;" id="monthApplyNum">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">应用市场</em><span
                                            id="appMarketMonthApplyNum">0</span></li>
                                    <li><em style="font-size: 8px">推广渠道</em><span id="channelMonthApplyNum">0</span>
                                    </li>
                                </ul>
                            </li>
                            <li><em>日分发系数</em><span style="color:#4398ea;font-size:40px;" id="dayRatio">0</span>
                                <ul class="clearfix">
                                    <li class="left"><em style="font-size: 8px">月分发系数</em><span id="monthRatio">0</span>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="block-statisTabel block-bg">
                    <a style="text-decoration:none;margin-top: 0px;border-radius:.5rem;background:#00a7e9;color:#fff;display:inline-block;line-height:2.6rem;padding:0 1rem;"
                       href="javascript:void(0);"
                       onclick="showApkDiv();">查看统计详情<i class="iconfont icon-arrow-up"></i></a>
                    <div id="appTable" class="con" style="display: none;margin-top: 10px">
                        <table id="dataTable" class="table table-bordered table-header">
                            <thead>
                            <tr>
                                <td class="w15">产品名称</td>
                                <td>日新增用户</td>
                                <td>月新增用户</td>
                                <td>日申请次数</td>
                                <td>月申请次数</td>
                            </tr>
                            </thead>
                            <tbody id="appList">
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="blck-chartlist clearfix">
                    <div class="blcik-histogram block-bg">
                        <div class="title clearfix" style="margin-left: 10px;"><em></em><span>应用市场数据分析</span></div>
                        <div class="con">
                            <div id="channelChart"></div>
                        </div>
                    </div>
                    <div class="blcik-piechart block-bg">
                        <div class="title clearfix" style="margin-left: 10px;"><em></em><span>借款申请分布图</span></div>
                        <div class="con">
                            <div id="applyChart"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>
</div>
<script type="text/javascript">
    function findByData() {
        var data = $("#searchForm").serialize();
        var param = "1=1&" + data;
        //加载app用户数
        var result = get(homeUrl, param);
        if (result.success) {
            $("#dayUserCount").text(result.data.dayUserCount);
            $("#appMarketDayNum").text(result.data.appMarketDayNum);
            $("#channelDayNum").text(result.data.channelDayNum);

            $("#monthUserCount").text(result.data.monthUserCount);
            $("#appMarketMonthNum").text(result.data.appMarketMonthNum);
            $("#channelMonthNum").text(result.data.channelMonthNum);

            $("#dayApplyCount").text(result.data.dayApplyCount);
            $("#appMarketDayApplyTime").text(result.data.appMarketDayApplyTime);
            $("#channelDayApplyNum").text(result.data.channelDayApplyNum);

            $("#applyNum").text(result.data.applyNum);
            $("#appMarketApplyNum").text(result.data.appMarketApplyNum);
            $("#channelApplyNum").text(result.data.channelApplyNum);

            $("#monthApplyCount").text(result.data.monthApplyCount);
            $("#appMarketMonthApplyTime").text(result.data.appMarketMonthApplyTime);
            $("#channelApplyTime").text(result.data.channelApplyTime);

            $("#monthApplyNum").text(result.data.monthApplyNum);
            $("#appMarketMonthApplyNum").text(result.data.appMarketMonthApplyNum);
            $("#channelMonthApplyNum").text(result.data.channelMonthApplyNum);

            $("#dayRatio").text(result.data.dayRatio);
            $("#monthRatio").text(result.data.monthRatio);
        } else {
            showTipMessage(result.message, true);
        }
    }

    function toggleData() {
        //加载数据
        findByData();
    }

    //加载app列表数据
    function initTableData(resultData) {
        $("#appList").empty();
        var sHtml = "";
        $.each(resultData, function (j) {
            var sTrHtml = "<tr>";
            sTrHtml += "<td>";
            sTrHtml += resultData[j].appName;
            sTrHtml += "</td>";

            sTrHtml += "<td>";
            sTrHtml += resultData[j].dayUserCount;
            sTrHtml += "</td>";

            sTrHtml += "<td>";
            sTrHtml += resultData[j].monthUserCount;
            sTrHtml += "</td>";

            sTrHtml += "<td>";
            sTrHtml += resultData[j].dayApplyCount;
            sTrHtml += "</td>";

            sTrHtml += "<td>";
            sTrHtml += resultData[j].monthApplyCount;
            sTrHtml += "</td>";

            sTrHtml += "</tr>";
            sHtml += sTrHtml;
        });
        $("#appList").append(sHtml);
    }

    function showApkDiv() {
        $("#dayHourTotal").css("display", "");
        $("#shopApply").css("display", "");
        $("#productApply").css("display", "");
        //初始化表数据
        if ($("#appList").html().replace(/(^\s*)|(\s*$)/g, '') == "") {
            var data = $("#searchForm").serialize();
            //加载app用户数
            var result = get(getAppUserUrl, data);
            if (result.success) {
                initTableData(result.data);
            }
        }
        $("#appTable").css("display", "");
    }

    $(function () {

        $("#navtop").load("top.html", function () {
            topFunc();
        });
        $("#left").load("left.html", function () {
            left();
        });
        findByData("all");
        var param = $("#searchForm").serialize();
        var result = get(appstoreCountUrl, param);
        if (result.success) {
            showChart("applyChart", result.data);
        }
        var resultChannel = get(appstoreListUrl, param);
        if (resultChannel.success) {
            showChannelChart("channelChart", resultChannel.data);
        }

        $("#sysdate").text(getCurrentDate());
        $("#weekShow").text(getWeek());

        function tabs(tabTit, on, tabCon) {
            $(tabTit).children().hover(function () {
                $(this).addClass(on).siblings().removeClass(on);
                var index = $(tabTit).children().index(this);
                $(tabCon).children().eq(index).show().siblings().hide();
            });
        };
        tabs(".tab-hd", "cur", ".tab-bd");
    });
</script>
</body>
</html>
